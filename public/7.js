(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{22:function(r,t,e){"use strict";function o(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}var n=function(){function r(){!function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.errors={}}var t,e,n;return t=r,(e=[{key:"has",value:function(r){return this.errors.hasOwnProperty(r)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(r){if(this.errors[r])return this.errors[r][0]}},{key:"record",value:function(r){this.errors=r}},{key:"clear",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;r?delete this.errors[r]:this.errors={}}}])&&o(t.prototype,e),n&&o(t,n),r}();function i(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}var s=function(){function r(t){for(var e in function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.originalData=t,t)this[e]=t[e];this.errors=new n}var t,e,o;return t=r,(e=[{key:"data",value:function(){var r={};for(var t in this.originalData)r[t]=this[t];return r}},{key:"reset",value:function(){for(var r in this.originalData)this[r]="";this.errors.clear()}},{key:"submit",value:function(r){var t=this;r.then(function(r){t.onSuccess(r)}).catch(function(r){t.onFail(r)})}},{key:"onSuccess",value:function(r){this.reset()}},{key:"onFail",value:function(r){this.errors.record(r)}}])&&i(t.prototype,e),o&&i(t,o),r}();t.a=s},71:function(r,t,e){"use strict";e.r(t);var o=e(4),n=e(6),i=e(22),s=e(2);function a(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})),e.push.apply(e,o)}return e}function c(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var u={name:"CreatePoll",data:function(){return{form:new i.a({question:null,description:null,group_id:null,max_check:1,options:["",""]})}},computed:function(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(e,!0).forEach(function(t){c(r,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):a(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))})}return r}({},Object(o.b)(["isAuthenticated","currentUser"]),{canDelete:function(){return this.form.options.length>2},groupOptions:function(){if(void 0!==this.currentUser.groups)return this.currentUser.groups.filter(function(r){return n.a.can("create-poll","Poll")}).map(function(r){return{value:r.id,text:r.name}})},isSubmitEnabled:function(){if(null===this.form.question||""===this.form.question)return!1;if(null===this.form.description||""===this.form.description)return!1;if(null===this.form.group_id)return!1;if(this.form.max_check<1||this.form.max_check>=this.form.options.length)return!1;for(var r=0;r<this.form.options.length;r++)if(""===this.form.options[r])return!1;return!0}}),methods:{addPollOption:function(){this.form.options.push("")},deletePollOption:function(r){this.form.options.splice(r,1)},submit:function(){var r=this,t=this.form.data(),e=this.$store.dispatch(s.n,t);e.then(function(){r.$router.push({name:"polls"})}),e.catch(function(r){}),this.form.submit(e)}}},l=e(1),f=Object(l.a)(u,function(){var r=this,t=r.$createElement,e=r._self._c||t;return e("div",[e("can",{attrs:{I:"create-poll",a:"Poll"}},[e("b-card",{staticClass:"my-4",attrs:{"bg-variant":"secondary","text-variant":"black"}},[e("div",{staticClass:"d-flex justify-content-between"},[e("h3",{staticClass:"m-0"},[r._v("Abstimmung erstellen")])])]),r._v(" "),e("b-card",{staticClass:"mt-3"},[e("b-form",{on:{submit:function(t){return t.preventDefault(),r.submit()},keydown:function(t){return r.form.errors.clear(t.target.name)}}},[e("b-form-group",{attrs:{id:"question-group",label:"Frage:","label-for":"question"}},[e("b-form-input",{attrs:{id:"question",required:"",placeholder:"Gib die Frage der Abstimmung ein."},model:{value:r.form.question,callback:function(t){r.$set(r.form,"question",t)},expression:"form.question"}}),r._v(" "),e("b-form-invalid-feedback",{attrs:{"force-show":r.form.errors.has("question")},domProps:{textContent:r._s(r.form.errors.get("question"))}})],1),r._v(" "),e("b-form-group",{attrs:{id:"description-group",label:"Beschreibung:","label-for":"description"}},[e("b-form-textarea",{attrs:{id:"description",rows:"3",placeholder:"Füge eine Beschreibung für die Abstimmung hinzu."},model:{value:r.form.description,callback:function(t){r.$set(r.form,"description",t)},expression:"form.description"}}),r._v(" "),e("b-form-invalid-feedback",{attrs:{"force-show":r.form.errors.has("description")},domProps:{textContent:r._s(r.form.errors.get("description"))}})],1),r._v(" "),e("b-form-group",{attrs:{id:"group-group",label:"Gruppe für die Abstimmung:","label-for":"group"}},[e("b-form-select",{attrs:{id:"group",options:r.groupOptions},model:{value:r.form.group_id,callback:function(t){r.$set(r.form,"group_id",t)},expression:"form.group_id"}}),r._v(" "),e("b-form-invalid-feedback",{attrs:{"force-show":r.form.errors.has("group_id")},domProps:{textContent:r._s(r.form.errors.get("group_id"))}})],1),r._v(" "),e("b-form-group",{attrs:{id:"max_check-group",label:"Anzahl der auswählbaren Antworten:","label-for":"max_check"}},[e("b-form-input",{attrs:{id:"max_check",type:"number",min:"1",step:1},model:{value:r.form.max_check,callback:function(t){r.$set(r.form,"max_check",t)},expression:"form.max_check"}}),r._v(" "),e("b-form-invalid-feedback",{attrs:{"force-show":r.form.errors.has("max_check")},domProps:{textContent:r._s(r.form.errors.get("max_check"))}})],1),r._v(" "),e("b-form-group",{attrs:{label:"Antwortmöglichkeiten:"}},[r._l(r.form.options,function(t,o){return e("b-card",{key:o,staticClass:"mb-2",attrs:{"bg-variant":"secondary"}},[e("div",{staticClass:"d-flex"},[e("b-input",{attrs:{placeholder:"Titel der Antwortmöglichkeit eingeben."},model:{value:r.form.options[o],callback:function(t){r.$set(r.form.options,o,t)},expression:"form.options[index]"}}),r._v(" "),r.canDelete?e("b-button",{staticClass:"ml-3",attrs:{variant:"danger"},on:{click:function(t){return r.deletePollOption(o)}}},[r._v("Löschen")]):r._e()],1)])}),r._v(" "),e("b-form-invalid-feedback",{attrs:{"force-show":r.form.errors.has("options")},domProps:{textContent:r._s(r.form.errors.get("questions"))}}),r._v(" "),e("div",{staticClass:"d-flex justify-content-end mt-4"},[e("b-button",{attrs:{variant:"primary"},on:{click:r.addPollOption}},[r._v("Weitere Antwortmöglichkeit hinzufügen")])],1)],2),r._v(" "),e("b-alert",{staticClass:"mt-2 mb-4",attrs:{show:r.form.errors.has("common"),variant:"danger"},domProps:{textContent:r._s(r.form.errors.get("common"))}}),r._v(" "),e("b-button",{attrs:{type:"submit",disabled:!r.isSubmitEnabled||r.form.errors.any(),block:"",variant:"success",size:"lg"}},[r._v("Abstimmung veröffentlichen")])],1)],1)],1)],1)},[],!1,null,"453e3cad",null);t.default=f.exports}}]);